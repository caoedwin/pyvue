webpackJsonp([16],{BO09:function(e,t){},HBgd:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"route-loading-container"},[t("div",{staticClass:"loading-spinner"}),this._v(" "),t("p",[this._v("正在加载路由，请稍候...")])])}]};var r=n("VU/8")({name:"RouteLoading"},a,!1,function(e){n("BO09")},"data-v-0f5f5b12",null);t.default=r.exports},IcnI:function(e,t,n){"use strict";n("1LXj"),n("3Ipg");var a=n("7+uW"),r=n("NYxO"),o=n("vLgD"),i=n("WR00"),c=n("kaBJ"),s=n("Gi/e"),u=n("35ow"),l=(n("enaP"),n("j3Ef"),n("qnda"),n("RiZp"),n("/TzG"),n("qpxo"),n("gfAo"),n("N8ck"),n("FgqS"),n("axQK"),n("vw/H"),n("XEfP"),n("Wse9"),n("ocEJ"),n("SgkS"),{namespaced:!0,state:{cabinets:[],currentCabinetId:null,isAdmin:!1,currentUser:null,CustomerOptions:[]},mutations:{SET_CABINETS:function(e,t){e.cabinets=t.cabinets,e.isAdmin=t.isAdmin,e.currentUser=t.currentUser,e.CustomerOptions=t.CustomerOptions},SET_CURRENT_CABINET:function(e,t){e.currentCabinetId=t},ADD_CABINET:function(e,t){e.cabinets.push(t)},UPDATE_GRID:function(e,t){var n=t.cabinetId,a=t.rowIndex,r=t.colIndex,o=t.data,i=e.cabinets.find(function(e){return e.id===n});i&&(i.gridData[a][r]=Object(u.a)(Object(u.a)({},i.gridData[a][r]),o))},REMOVE_CABINET:function(e,t){e.cabinets=e.cabinets.filter(function(e){return e.id!==t})}},actions:{fetchCabinetData:function(e){return Object(s.a)(Object(c.a)().m(function t(){var n,a,r;return Object(c.a)().w(function(t){for(;;)switch(t.p=t.n){case 0:return n=e.commit,t.p=1,t.n=2,cabinetApi.getCabinetData();case 2:return a=t.v,n("SET_CABINETS",a.data),t.a(2,a.data);case 3:throw t.p=3,r=t.v,new Error("获取柜体数据失败: "+r.message);case 4:return t.a(2)}},t,null,[[1,3]])}))()},addCabinet:function(e,t){return Object(s.a)(Object(c.a)().m(function n(){var a,r,o;return Object(c.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=e.commit,n.p=1,n.n=2,cabinetApi.addCabinet(t);case 2:return r=n.v,a("ADD_CABINET",r.data),n.a(2,r.data);case 3:throw n.p=3,o=n.v,new Error("添加柜体失败: "+o.message);case 4:return n.a(2)}},n,null,[[1,3]])}))()},deleteCabinet:function(e,t){return Object(s.a)(Object(c.a)().m(function n(){var a,r;return Object(c.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=e.commit,n.p=1,n.n=2,cabinetApi.deleteCabinet(t);case 2:a("REMOVE_CABINET",t),n.n=4;break;case 3:throw n.p=3,r=n.v,new Error("删除柜体失败: "+r.message);case 4:return n.a(2)}},n,null,[[1,3]])}))()},updateGrid:function(e,t){return Object(s.a)(Object(c.a)().m(function n(){var a,r,o,s,u,l,d,m,p,f;return Object(c.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=e.commit,r=t.gridId,o=t.data,n.p=1,n.n=2,cabinetApi.updateGrid(r,o);case 2:return s=n.v,u=r.split("-").map(function(e){return e.includes("row")?parseInt(e.replace("row","")):e.includes("col")?parseInt(e.replace("col","")):parseInt(e)}),l=Object(i.a)(u,3),d=l[0],m=l[1],p=l[2],a("UPDATE_GRID",{cabinetId:d,rowIndex:m,colIndex:p,data:s.data}),n.a(2,s.data);case 3:throw n.p=3,f=n.v,new Error("更新柜格信息失败: "+f.message);case 4:return n.a(2)}},n,null,[[1,3]])}))()},reserveCell:function(e,t){return Object(s.a)(Object(c.a)().m(function n(){var a,r,o,s,l,d,m,p,f,h;return Object(c.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=e.commit,r=t.gridId,o=t.data,n.p=1,n.n=2,cabinetApi.reserveCell(r,o);case 2:return s=n.v,l=r.split("-").map(function(e){return e.includes("row")?parseInt(e.replace("row","")):e.includes("col")?parseInt(e.replace("col","")):parseInt(e)}),d=Object(i.a)(l,3),m=d[0],p=d[1],f=d[2],a("UPDATE_GRID",{cabinetId:m,rowIndex:p,colIndex:f,data:Object(u.a)({status:2},s.data)}),n.a(2,s.data);case 3:throw n.p=3,h=n.v,new Error("预约柜格失败: "+h.message);case 4:return n.a(2)}},n,null,[[1,3]])}))()},cancelReservation:function(e,t){return Object(s.a)(Object(c.a)().m(function n(){var a,r,o,s,l,d,m,p;return Object(c.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=e.commit,n.p=1,n.n=2,cabinetApi.cancelReservation(t);case 2:return r=n.v,o=t.split("-").map(function(e){return e.includes("row")?parseInt(e.replace("row","")):e.includes("col")?parseInt(e.replace("col","")):parseInt(e)}),s=Object(i.a)(o,3),l=s[0],d=s[1],m=s[2],a("UPDATE_GRID",{cabinetId:l,rowIndex:d,colIndex:m,data:Object(u.a)({status:0,user:null},r.data)}),n.a(2,r.data);case 3:throw n.p=3,p=n.v,new Error("取消预约失败: "+p.message);case 4:return n.a(2)}},n,null,[[1,3]])}))()},confirmBorrow:function(e,t){return Object(s.a)(Object(c.a)().m(function n(){var a,r,o,s,l,d,m,p;return Object(c.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=e.commit,n.p=1,n.n=2,cabinetApi.confirmBorrow(t);case 2:return r=n.v,o=t.split("-").map(function(e){return e.includes("row")?parseInt(e.replace("row","")):e.includes("col")?parseInt(e.replace("col","")):parseInt(e)}),s=Object(i.a)(o,3),l=s[0],d=s[1],m=s[2],a("UPDATE_GRID",{cabinetId:l,rowIndex:d,colIndex:m,data:Object(u.a)({status:1},r.data)}),n.a(2,r.data);case 3:throw n.p=3,p=n.v,new Error("确认借出失败: "+p.message);case 4:return n.a(2)}},n,null,[[1,3]])}))()},takeOutCell:function(e,t){return Object(s.a)(Object(c.a)().m(function n(){var a,r,o,s,l,d,m,p,f,h;return Object(c.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=e.commit,r=t.gridId,o=t.data,n.p=1,n.n=2,cabinetApi.takeOutCell(r,o);case 2:return s=n.v,l=r.split("-").map(function(e){return e.includes("row")?parseInt(e.replace("row","")):e.includes("col")?parseInt(e.replace("col","")):parseInt(e)}),d=Object(i.a)(l,3),m=d[0],p=d[1],f=d[2],a("UPDATE_GRID",{cabinetId:m,rowIndex:p,colIndex:f,data:Object(u.a)({status:3},s.data)}),n.a(2,s.data);case 3:throw n.p=3,h=n.v,new Error("取出保留失败: "+h.message);case 4:return n.a(2)}},n,null,[[1,3]])}))()},cancelTakenReserve:function(e,t){return Object(s.a)(Object(c.a)().m(function n(){var a,r,o,s,l,d,m,p;return Object(c.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=e.commit,n.p=1,n.n=2,cabinetApi.cancelTakenReserve(t);case 2:return r=n.v,o=t.split("-").map(function(e){return e.includes("row")?parseInt(e.replace("row","")):e.includes("col")?parseInt(e.replace("col","")):parseInt(e)}),s=Object(i.a)(o,3),l=s[0],d=s[1],m=s[2],a("UPDATE_GRID",{cabinetId:l,rowIndex:d,colIndex:m,data:Object(u.a)({status:0,user:null},r.data)}),n.a(2,r.data);case 3:throw n.p=3,p=n.v,new Error("取消保留失败: "+p.message);case 4:return n.a(2)}},n,null,[[1,3]])}))()},returnCell:function(e,t){return Object(s.a)(Object(c.a)().m(function n(){var a,r,o,s,l,d,m,p;return Object(c.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=e.commit,n.p=1,n.n=2,cabinetApi.returnCell(t);case 2:return r=n.v,o=t.split("-").map(function(e){return e.includes("row")?parseInt(e.replace("row","")):e.includes("col")?parseInt(e.replace("col","")):parseInt(e)}),s=Object(i.a)(o,3),l=s[0],d=s[1],m=s[2],a("UPDATE_GRID",{cabinetId:l,rowIndex:d,colIndex:m,data:Object(u.a)({status:0,user:null},r.data)}),n.a(2,r.data);case 3:throw n.p=3,p=n.v,new Error("归还柜格失败: "+p.message);case 4:return n.a(2)}},n,null,[[1,3]])}))()}},getters:{cabinets:function(e){return e.cabinets},currentCabinetId:function(e){return e.currentCabinetId},isAdmin:function(e){return e.isAdmin},currentUser:function(e){return e.currentUser},CustomerOptions:function(e){return e.CustomerOptions},currentCabinet:function(e){return e.cabinets.find(function(t){return t.id===e.currentCabinetId})||{}}}});a.default.use(r.a);t.a=new r.a.Store({modules:{cabinet:l},state:{token:localStorage.getItem("token")||"",user:JSON.parse(localStorage.getItem("user")||"null"),menuTree:[],isCollapse:!1,menuPosition:"left",routeLoading:!1},mutations:{SET_TOKEN:function(e,t){e.token=t,localStorage.setItem("token",t)},SET_USER:function(e,t){e.user=t,localStorage.setItem("user",JSON.stringify(t))},SET_MENU_TREE:function(e,t){e.menuTree=t,localStorage.setItem("menuTree",JSON.stringify(t))},TOGGLE_COLLAPSE:function(e){e.isCollapse=!e.isCollapse},SET_COLLAPSE:function(e,t){e.isCollapse=t},SET_MENU_POSITION:function(e,t){e.menuPosition=t},SET_ROUTE_LOADING:function(e,t){e.routeLoading=t},LOGOUT:function(e){e.token="",e.user=null,e.menuTree=[],e.isCollapse=!1,e.menuPosition="left",e.routeLoading=!1,localStorage.removeItem("token"),localStorage.removeItem("menuTree"),localStorage.removeItem("user")}},actions:{login:function(e,t){var n=e.commit,a=t.token,r=t.user;n("SET_TOKEN",a),n("SET_USER",r),n("SET_MENU_TREE",r.menu_tree||[])},fetchUserInfo:function(e){var t=e.commit;return o.a.get("/api/userinfo/").then(function(e){var n=e.data,a=n.menu_tree||[];t("SET_USER",n),t("SET_MENU_TREE",a),localStorage.setItem("menuTree",JSON.stringify(a))}).catch(function(e){var t;throw 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&localStorage.removeItem("token"),e})},logout:function(e){(0,e.commit)("LOGOUT")},toggleCollapse:function(e){(0,e.commit)("TOGGLE_COLLAPSE")},setCollapse:function(e,t){(0,e.commit)("SET_COLLAPSE",t)},setMenuPosition:function(e,t){(0,e.commit)("SET_MENU_POSITION",t)},setRouteLoading:function(e,t){(0,e.commit)("SET_ROUTE_LOADING",t)},setUser:function(e,t){(0,e.commit)("SET_USER",t)}},getters:{isLoggedIn:function(e){return!!e.token},currentUser:function(e){return e.user},menuTree:function(e){return e.menuTree},isCollapse:function(e){return e.isCollapse},menuPosition:function(e){return e.menuPosition},routeLoading:function(e){return e.routeLoading}}})},JU1R:function(e,t,n){"use strict";var a=n("kaBJ"),r=n("Gi/e"),o=(n("wiMi"),n("RiZp"),n("/TzG"),n("qpxo"),n("YY9M"),n("gfAo"),n("6TLk"),n("axQK"),n("DIM5"),n("1LXj"),n("3Ipg"),n("vw/H"),n("Wse9"),n("GPcm"),n("J5eo"),n("3mz+"),n("7+uW")),i=n("/ocq"),c=n("R8Ol"),s=n("35ow"),u=n("NYxO"),l=(n("eI0Z"),n("waNl"),{computed:{breadcrumb:function(){var e=new Map;return this.$route.matched.reduce(function(t,n){return n.meta&&n.meta.title&&!n.meta.hideInBreadcrumb?(e.has(n.path)||(e.set(n.path,!0),t.push(n)),t):t},[])}},methods:{isCurrentRoute:function(e){return this.$route.path===e.path}}}),d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},e._l(e.breadcrumb,function(t,a){return n("el-breadcrumb-item",{key:a,attrs:{to:e.isCurrentRoute(t)?null:t.path}},[e._v("\n    "+e._s(t.meta.title)+"\n  ")])}),1)},staticRenderFns:[]};var m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("section",{staticClass:"app-main"},[t("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[t("router-view",{key:this.key})],1)],1)},staticRenderFns:[]};var p={name:"Layout",components:{Breadcrumb:n("VU/8")(l,d,!1,function(e){n("jtN/")},"data-v-d2509412",null).exports,AppMain:n("VU/8")({name:"AppMain",computed:{key:function(){return this.$route.path}}},m,!1,function(e){n("OI7L")},"data-v-abc9c808",null).exports,RouteLoading:n("HBgd").default},computed:Object(s.a)(Object(s.a)({},Object(u.c)(["menuTree","isCollapse","menuPosition","currentUser"])),{},{activeMenu:function(){return this.$route.path},menuPositionClass:function(){return"menu-".concat(this.menuPosition)},isTopLevelLayout:function(){var e=this.$route.matched;return e[0]&&e[0].meta&&!0===e[0].meta.isRootLayout},userName:function(){var e;return(null===(e=this.currentUser)||void 0===e?void 0:e.username)||"用户"}}),methods:Object(s.a)(Object(s.a)({},Object(u.b)(["setCollapse","setRouteLoading"])),{},Object(c.a)(Object(c.a)(Object(c.a)({toggleMenuPosition:function(){var e="left"===this.menuPosition?"top":"left";this.$store.dispatch("setMenuPosition",e),"left"===e&&this.isCollapse&&this.setCollapse(!1)},handleSelect:function(e){this.navigate(e)},navigate:function(e){var t=this;this.$route.path!==e&&(this.$router.resolve(e).route.matched.length?this.$router.push(e).catch(function(e){"NavigationDuplicated"!==e.name&&console.error(e)}):(console.warn("路由 ".concat(e," 不存在")),this.setRouteLoading(!0),setTimeout(function(){return t.$router.push("/dashboard")},1e3)))},toggleCollapse:function(){this.$store.commit("TOGGLE_COLLAPSE")}},"handleSelect",function(e,t){console.log(e,t)}),"confirmLogout",function(){var e=this;this.$confirm("确定要注销登录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.handleLogout()}).catch(function(){})}),"handleLogout",function(){localStorage.removeItem("token"),localStorage.removeItem("menuTree"),localStorage.removeItem("user"),this.$store.commit("SET_MENU_TREE",[]),this.$store.commit("SET_TOKEN",null),this.$store.commit("SET_USER",null),this.$router.push("/login"),this.$message({type:"success",message:"注销成功!"})}))},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-wrapper",class:e.menuPositionClass},["top"===e.menuPosition?n("div",{ref:"topMenu",staticClass:"top-menu-container"},[n("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeMenu,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:""},on:{select:e.handleSelect}},[n("el-menu-item",{attrs:{index:"/dashboard"}},[n("i",{staticClass:"el-icon-dashboard"}),e._v(" "),n("span",[e._v("控制面板")])]),e._v(" "),e._l(e.menuTree,function(t){return[t.children&&t.children.length?[n("el-submenu",{key:t.id,attrs:{index:t.id.toString()},scopedSlots:e._u([{key:"title",fn:function(){return[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])]},proxy:!0}],null,!0)},[e._v(" "),e._l(t.children,function(t){return[t.children&&t.children.length?n("el-submenu",{key:t.id,attrs:{index:t.id.toString()},scopedSlots:e._u([{key:"title",fn:function(){return[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])]},proxy:!0}],null,!0)},[e._v(" "),e._l(t.children,function(t){return n("el-menu-item",{key:t.id,attrs:{index:t.path}},[n("span",[e._v(e._s(t.title))])])})],2):n("el-menu-item",{key:t.id,attrs:{index:t.path}},[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])])]})],2)]:n("el-menu-item",{key:t.id,attrs:{index:t.path}},[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])])]}),e._v(" "),n("el-submenu",{staticClass:"user-submenu",attrs:{index:"user-menu"},scopedSlots:e._u([{key:"title",fn:function(){return[n("i",{staticClass:"el-icon-user"}),e._v(" "),n("span",[e._v(e._s(e.userName))])]},proxy:!0}],null,!1,3749482772)},[e._v(" "),n("el-menu-item",{on:{click:e.confirmLogout}},[n("i",{staticClass:"el-icon-switch-button"}),e._v(" "),n("span",[e._v("注销")])])],1)],2)],1):n("div",{staticClass:"sidebar-container",class:{collapsed:e.isCollapse}},["left"===e.menuPosition?n("div",{staticClass:"collapse-control"},[n("el-radio-group",{attrs:{value:e.isCollapse,size:"mini"},on:{input:e.setCollapse}},[n("el-radio-button",{attrs:{label:!1}},[e._v("展开")]),e._v(" "),n("el-radio-button",{attrs:{label:!0}},[e._v("收起")])],1)],1):e._e(),e._v(" "),n("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activeMenu,collapse:e.isCollapse,"background-color":"#304156","text-color":"#bfcbd9","active-text-color":"#409EFF"}},[n("el-menu-item",{attrs:{index:"/dashboard"},on:{click:function(t){return e.navigate("/dashboard")}}},[n("i",{staticClass:"el-icon-dashboard"}),e._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("控制面板")])]),e._v(" "),e._l(e.menuTree,function(t){return[t.children&&t.children.length?[n("el-submenu",{key:t.id,attrs:{index:t.id.toString()},scopedSlots:e._u([{key:"title",fn:function(){return[n("i",{class:t.icon}),e._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]},proxy:!0}],null,!0)},[e._v(" "),e._l(t.children,function(t){return[t.children&&t.children.length?n("el-submenu",{key:t.id,attrs:{index:t.id.toString()},scopedSlots:e._u([{key:"title",fn:function(){return[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])]},proxy:!0}],null,!0)},[e._v(" "),e._l(t.children,function(t){return n("el-menu-item",{key:t.id,attrs:{index:t.path},on:{click:function(n){return e.navigate(t.path)}}},[n("span",[e._v(e._s(t.title))])])})],2):n("el-menu-item",{key:t.id,attrs:{index:t.path},on:{click:function(n){return e.navigate(t.path)}}},[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))])])]})],2)]:n("el-menu-item",{key:t.id,attrs:{index:t.path},on:{click:function(n){return e.navigate(t.path)}}},[n("i",{class:t.icon}),e._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])]}),e._v(" "),n("el-submenu",{staticClass:"user-submenu",attrs:{index:"user-menu"},scopedSlots:e._u([{key:"title",fn:function(){return[n("i",{staticClass:"el-icon-user"}),e._v(" "),n("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.userName))])]},proxy:!0}])},[e._v(" "),n("el-menu-item",{on:{click:e.confirmLogout}},[n("i",{staticClass:"el-icon-switch-button"}),e._v(" "),n("span",[e._v("注销")])])],1)],2)],1),e._v(" "),n("div",{staticClass:"main-container",class:{"main-container-top":"top"===e.menuPosition}},[e.isTopLevelLayout?n("div",{staticClass:"navbar"},[n("breadcrumb"),e._v(" "),n("div",{staticClass:"right-menu"},[n("el-button",{attrs:{size:"mini"},on:{click:e.toggleMenuPosition}},[e._v("\n          "+e._s("left"===e.menuPosition?"切换顶部菜单":"切换侧边菜单")+"\n        ")])],1)],1):e._e(),e._v(" "),e.$store.state.routeLoading?n("div",{staticClass:"route-loading-overlay"},[n("route-loading")],1):n("app-main")],1)])},staticRenderFns:[]};var h=n("VU/8")(p,f,!1,function(e){n("m4eH")},"data-v-124b9eef",null).exports,v=n("IcnI");t.a=I,o.default.use(i.a);var b=[{path:"/login",name:"Login",component:function(){return n.e(6).then(n.bind(null,"lmfZ"))},hidden:!0},{path:"/404",component:function(){return n.e(0).then(n.bind(null,"+H76"))},name:"NotFound",hidden:!0},{path:"/route-loading",component:function(){return new Promise(function(e){e()}).then(n.bind(null,"HBgd"))},name:"RouteLoading",hidden:!0},{path:"/register",component:function(){return n.e(4).then(n.bind(null,"tcoL"))},name:"Register",hidden:!0,meta:{anonymous:!0}},{path:"/forgot-password",component:function(){return n.e(3).then(n.bind(null,"eRj+"))},name:"ForgotPassword",hidden:!0,meta:{anonymous:!0}},{path:"/reset-password",component:function(){return n.e(5).then(n.bind(null,"oisi"))},name:"ResetPassword",hidden:!0,meta:{anonymous:!0}}],g=new i.a({mode:"history",base:Object({NODE_ENV:"production"}).BASE_URL,routes:b});function _(e){return g.getRoutes().some(function(t){return t.name===e})}function I(e){if(_("Wildcard"))try{g.removeRoute("Wildcard")}catch(e){console.warn("移除通配符路由失败",e)}var t={path:"/",component:h,redirect:"/dashboard",name:"Layout",meta:{isRootLayout:!0,hideInBreadcrumb:!0},children:[{path:"/dashboard",component:function(){return n.e(2).then(n.bind(null,"npFY"))},name:"Dashboard",meta:{title:"控制面板",icon:"dashboard"}}]},a=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e.forEach(function(e){if(e.children&&e.children.length){var i={path:e.path||"/menu-".concat(e.id),component:0===o?function(){return n.e(1).then(n.bind(null,"WImY"))}:null,name:"Menu_".concat(e.id),meta:{title:e.title,icon:e.icon,hideInBreadcrumb:o>0},redirect:e.children[0].path,children:[]};r?r.children.push(i):t.children.push(i),a(e.children,i,o+1)}else if(e.path){console.log(e,e.component,e.path);var c={path:e.path,component:function(){return n("Opzk")("./".concat(e.component||"EmptyPage",".vue"))},name:"Page_".concat(e.id),meta:{icon:e.icon,isLeaf:!0}};r?r.children.push(c):t.children.push(c)}})};if(a(e),_("Layout"))try{g.removeRoute("Layout")}catch(e){console.warn("移除旧布局路由失败",e)}g.addRoute(t),g.addRoute({path:"*",redirect:"/404",name:"Wildcard",hidden:!0}),console.log("动态路由添加完成",g.getRoutes())}g.beforeEach(function(){var e=Object(r.a)(Object(a.a)().m(function e(t,n,r){var o,i,c;return Object(a.a)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("路由跳转: ".concat(n.path," → ").concat(t.path)),console.log("路由匹配记录:",t.matched.map(function(e){return e.path})),console.log("路由名称:",t.matched.map(function(e){return e.name})),!["/login","/404","/route-loading"].includes(t.path)){e.n=1;break}return e.a(2,r());case 1:if(localStorage.getItem("token")){e.n=2;break}return e.a(2,r("/login"));case 2:if(0!==v.a.state.menuTree.length){e.n=7;break}if(e.p=3,o=JSON.parse(localStorage.getItem("menuTree")||"[]"),console.log("从localStorage读取的menuTree:",JSON.stringify(o)),!o.length){e.n=4;break}return v.a.commit("SET_MENU_TREE",o),I(o),e.a(2,r(t.path));case 4:return e.n=5,v.a.dispatch("fetchUserInfo");case 5:console.log("从API获取的menuTree:",v.a.state.menuTree),I(v.a.state.menuTree),e.n=7;break;case 6:return e.p=6,c=e.v,console.error("路由加载失败:",c),localStorage.removeItem("token"),e.a(2,r("/login"));case 7:if(!v.a.state.user&&localStorage.getItem("user")&&(i=JSON.parse(localStorage.getItem("user")),v.a.commit("SET_USER",i)),!t.meta.anonymous){e.n=8;break}return e.a(2,r());case 8:if(0!==t.matched.length){e.n=9;break}return console.warn("路由未匹配: ".concat(t.path)),e.a(2,r("/404"));case 9:r();case 10:return e.a(2)}},e,null,[[3,6]])}));return function(t,n,a){return e.apply(this,arguments)}}());t.b=g},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var o=n("VU/8")({name:"App"},r,!1,function(e){n("yXOP")},null,null).exports,i=n("JU1R"),c=n("IcnI"),s=(n("ODBI"),n("zL8q")),u=n.n(s);n("tvR6");a.default.use(u.a),a.default.config.productionTip=!1,new a.default({router:i.b,store:c.a,render:function(e){return e(o)}}).$mount("#app")},OI7L:function(e,t){},Opzk:function(e,t,n){var a={"./404.vue":["+H76",0],"./About.vue":["vu9I",14],"./Dashboard.vue":["npFY",2],"./EmptyPage.vue":["U29U",8],"./ForgotPassword.vue":["eRj+",3],"./Home.vue":["j7e0",13],"./IntelligentCabinet/SmartCabinet.vue":["DHAS",11],"./Login.vue":["lmfZ",6],"./Login202508211620.vue":["GvSF",10],"./Login202508251610.vue":["cGQG",9],"./Login202509021000.vue":["PDke",7],"./NestedContainer.vue":["WImY",1],"./NestedContainer202508251610.vue":["D6ep",12],"./Register.vue":["tcoL",4],"./ResetPassword.vue":["oisi",5],"./RouteLoading.vue":["HBgd"]};function r(e){var t=a[e];return t?Promise.all(t.slice(1).map(n.e)).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}r.keys=function(){return Object.keys(a)},r.id="Opzk",e.exports=r},SgkS:function(e,t,n){"use strict";t.e=i,t.a=function(e){return Object(a.a)({url:"/IntelligentCabinet/cabinets/",method:"post",headers:{"X-CSRFToken":o.a.get("csrftoken")},data:{isGetData:"addCabinet",newCabinet:e}})},t.d=function(e){return Object(a.a)({url:"/IntelligentCabinet/cabinets/".concat(e,"/"),method:"delete",headers:{"X-CSRFToken":o.a.get("csrftoken")},data:{isGetData:"deleteCabinet"}})},t.g=function(e,t){return Object(a.a)({url:"/IntelligentCabinet/grids/".concat(e,"/update/"),method:"patch",headers:{"X-CSRFToken":o.a.get("csrftoken")},data:{isGetData:"updategrid",cabinet:e,gridinfo:t}})},t.f=function(e,t){return Object(a.a)({url:"/IntelligentCabinet/grids/".concat(e,"/reserve/"),method:"post",headers:{"X-CSRFToken":o.a.get("csrftoken")},data:t})},t.b=function(e,t){return Object(a.a)({url:"/IntelligentCabinet/grids/".concat(e,"/cancel-reserve/"),method:"post",headers:{"X-CSRFToken":o.a.get("csrftoken")},data:t})},t.c=function(e,t){return Object(a.a)({url:"/IntelligentCabinet/grids/".concat(e,"/confirm-borrow/"),method:"post",headers:{"X-CSRFToken":o.a.get("csrftoken")},data:t})};var a=n("vLgD"),r=n("ZQ6q"),o=n.n(r);function i(e){return Object(a.a)({url:"/IntelligentCabinet/init-data/",method:"get",params:e})}},"jtN/":function(e,t){},m4eH:function(e,t){},tvR6:function(e,t){},vLgD:function(e,t,n){"use strict";var a=n("RiZp"),r=(n.n(a),n("vw/H")),o=(n.n(r),n("kyeA")),i=(n.n(o),n("Wse9")),c=(n.n(i),n("mtWM")),s=n.n(c);s.a.defaults.withCredentials=!0;var u=s.a.create({baseURL:"http://127.0.0.1:8000",withCredentials:!0,timeout:5e3});u.interceptors.request.use(function(e){if(e.withCredentials=!0,e.url.endsWith("/login/"))return e;var t=localStorage.getItem("token");return console.log(t,"utils/resquest"),t&&(e.headers.Authorization="Bearer ".concat(t)),e}),u.interceptors.response.use(function(e){return e},function(e){var t;return console.log("error.message",e.message),(401===(null===(t=e.response)||void 0===t?void 0:t.status)||e.message.includes("401")||e.message.includes("Unauthorized"))&&(localStorage.removeItem("token"),localStorage.removeItem("menuTree"),window.location.href="/login"),Promise.reject(e)}),t.a=u},yXOP:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.230bdfb9b5c80b0ed378.js.map