webpackJsonp([3],{EGbP:function(e,o){},lmfZ:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});t("qpxo"),t("YY9M"),t("1LXj"),t("vw/H");var n=t("vLgD"),a=t("mtWM"),r=t.n(a),s=t("JU1R"),i={data:function(){return{loginForm:{account:"",password:""},loading:!1}},methods:{handleLogin:function(){var e=this;this.loading=!0,n.a.post("/api/login/",{account:this.loginForm.account,password:this.loginForm.password}).then(function(o){console.log("登录响应:",o.data);var t=o.data.access;localStorage.setItem("token",t),r.a.defaults.headers.common.Authorization="Bearer ".concat(t),e.$store.commit("SET_TOKEN",t),o.data&&e.$store.commit("SET_USER",o.data.user);var n=o.data.user.menu_tree||[];localStorage.setItem("token",t),e.$store.commit("SET_MENU_TREE",n),localStorage.setItem("menuTree",JSON.stringify(n)),Object(s.a)(n);var a=n.length>0&&n[0].path||"/dashboard";setTimeout(function(){console.log("尝试跳转到: ".concat(a)),e.$router.push(a).catch(function(o){"NavigationDuplicated"!==o.name&&(console.error("导航错误:",o),e.$router.push("/dashboard"))})},200)}).catch(function(o){console.error("登录过程中发生错误:",o);var t="登录失败";o.response&&(401===o.response.status?t="账号或密码错误":o.response.data&&o.response.data.detail&&(t=o.response.data.detail)),e.$message.error(t)}).finally(function(){e.loading=!1})}}},l={render:function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"login-container"},[t("el-form",{ref:"form",staticClass:"login-form",attrs:{model:e.loginForm}},[t("h2",[e._v("系统登录")]),e._v(" "),t("el-form-item",[t("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"账号"},model:{value:e.loginForm.account,callback:function(o){e.$set(e.loginForm,"account",o)},expression:"loginForm.account"}})],1),e._v(" "),t("el-form-item",[t("el-input",{attrs:{"prefix-icon":"el-icon-lock",type:"password",placeholder:"密码"},nativeOn:{keyup:function(o){return!o.type.indexOf("key")&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.handleLogin(o)}},model:{value:e.loginForm.password,callback:function(o){e.$set(e.loginForm,"password",o)},expression:"loginForm.password"}})],1),e._v(" "),t("el-form-item",[t("el-button",{staticClass:"login-btn",attrs:{type:"primary",loading:e.loading},on:{click:e.handleLogin}},[e._v("登录")])],1)],1)],1)},staticRenderFns:[]};var c=t("VU/8")(i,l,!1,function(e){t("EGbP")},"data-v-78aea95e",null);o.default=c.exports}});
//# sourceMappingURL=3.df4876b276769bd5353e.js.map