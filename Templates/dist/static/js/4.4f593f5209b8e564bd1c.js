webpackJsonp([4],{DS5Q:function(e,r){},tcoL:function(e,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=o("kaBJ"),s=o("Gi/e"),n=(o("qpxo"),o("XEfP"),o("BQbq"),o("vLgD")),i=o("ZQ6q"),a=o.n(i);var c={data:function(){return{registerForm:{phone:"",code:"",password:"",confirmPassword:""},loading:!1,codeButtonText:"获取验证码",codeButtonDisabled:!1,countdown:60}},methods:{sendVerificationCode:function(){var e=this;return Object(s.a)(Object(t.a)().m(function r(){var o;return Object(t.a)().w(function(r){for(;;)switch(r.p=r.n){case 0:if(e.registerForm.phone&&/^1[3-9]\d{9}$/.test(e.registerForm.phone)){r.n=1;break}return e.$message.error("请输入有效的手机号码"),r.a(2);case 1:return e.codeButtonDisabled=!0,r.p=2,r.n=3,t={phone:e.registerForm.phone,type:"register"},Object(n.a)({url:"/api/send_verification_code/",method:"post",headers:{"X-CSRFToken":a.a.get("csrftoken")},data:t});case 3:r.v,e.startCountdown(),e.$message.success("验证码已发送"),r.n=5;break;case 4:r.p=4,o=r.v,console.error("发送验证码失败:",o),e.$message.error("发送验证码失败"),e.codeButtonDisabled=!1;case 5:return r.a(2)}var t},r,null,[[2,4]])}))()},startCountdown:function(){var e=this,r=setInterval(function(){e.codeButtonText="".concat(e.countdown,"秒后重新获取"),e.countdown--,e.countdown<0&&(clearInterval(r),e.codeButtonText="获取验证码",e.codeButtonDisabled=!1,e.countdown=60)},1e3)},handleRegister:function(){var e=this;return Object(s.a)(Object(t.a)().m(function r(){var o,s,i;return Object(t.a)().w(function(r){for(;;)switch(r.p=r.n){case 0:if(e.registerForm.password===e.registerForm.confirmPassword){r.n=1;break}return e.$message.error("两次输入的密码不一致"),r.a(2);case 1:return e.loading=!0,r.p=2,r.n=3,n.a.post("/api/register/",{phone:e.registerForm.phone,code:e.registerForm.code,password:e.registerForm.password});case 3:r.v,e.$message.success("注册成功"),e.$router.push("/login"),r.n=5;break;case 4:r.p=4,i=r.v,console.error("注册失败:",i),e.$message.error((null===(o=i.response)||void 0===o?void 0:null===(s=o.data)||void 0===s?void 0:s.detail)||"注册失败");case 5:return r.p=5,e.loading=!1,r.f(5);case 6:return r.a(2)}},r,null,[[2,4,5,6]])}))()},goToLogin:function(){this.$router.push("/login")}}},l={render:function(){var e=this,r=e.$createElement,o=e._self._c||r;return o("div",{staticClass:"register-container"},[o("el-form",{ref:"form",staticClass:"register-form",attrs:{model:e.registerForm}},[o("h2",[e._v("用户注册")]),e._v(" "),o("el-form-item",[o("el-input",{attrs:{"prefix-icon":"el-icon-mobile-phone",placeholder:"手机号码",maxlength:"11"},model:{value:e.registerForm.phone,callback:function(r){e.$set(e.registerForm,"phone",r)},expression:"registerForm.phone"}})],1),e._v(" "),o("el-form-item",[o("div",{staticClass:"code-input"},[o("el-input",{staticStyle:{width:"60%"},attrs:{"prefix-icon":"el-icon-message",placeholder:"验证码"},model:{value:e.registerForm.code,callback:function(r){e.$set(e.registerForm,"code",r)},expression:"registerForm.code"}}),e._v(" "),o("el-button",{staticStyle:{width:"35%","margin-left":"5%"},attrs:{type:"primary",disabled:e.codeButtonDisabled},on:{click:e.sendVerificationCode}},[e._v("\n          "+e._s(e.codeButtonText)+"\n        ")])],1)]),e._v(" "),o("el-form-item",[o("el-input",{attrs:{"prefix-icon":"el-icon-lock",type:"password",placeholder:"设置密码","show-password":""},model:{value:e.registerForm.password,callback:function(r){e.$set(e.registerForm,"password",r)},expression:"registerForm.password"}})],1),e._v(" "),o("el-form-item",[o("el-input",{attrs:{"prefix-icon":"el-icon-lock",type:"password",placeholder:"确认密码","show-password":""},model:{value:e.registerForm.confirmPassword,callback:function(r){e.$set(e.registerForm,"confirmPassword",r)},expression:"registerForm.confirmPassword"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"register-btn",attrs:{type:"primary",loading:e.loading},on:{click:e.handleRegister}},[e._v("注册")])],1),e._v(" "),o("div",{staticClass:"login-link"},[o("el-link",{attrs:{type:"primary"},on:{click:e.goToLogin}},[e._v("返回登录")])],1)],1)],1)},staticRenderFns:[]};var d=o("VU/8")(c,l,!1,function(e){o("DS5Q")},"data-v-6ba6f09a",null);r.default=d.exports}});
//# sourceMappingURL=4.4f593f5209b8e564bd1c.js.map