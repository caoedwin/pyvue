webpackJsonp([11],{"+jmy":function(e,t){},DHAS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("FgC/");var n=a("UeLd");function s(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Object(n.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=a("kaBJ"),l=a("Gi/e"),i=a("35ow"),c=(a("AaIv"),a("45zI"),a("wiMi"),a("qnda"),a("vQY2"),a("RiZp"),a("/TzG"),a("qpxo"),a("YY9M"),a("gfAo"),a("FgqS"),a("6TLk"),a("axQK"),a("vw/H"),a("Wse9"),a("DCb3"),a("J5eo"),a("NYxO")),u=a("SgkS"),d={name:"SmartCabinet",data:function(){return{currentCabinetId:null,isAdmin_origin:!0,isAdmin:!0,currentUser:{},CustomerOptions:[],tableloading:!1,elbuttonloading:!1,errMsg:"",dialogAdminVisible:!1,dialogUserBorrowVisible:!1,dialogAddVisible:!1,dialogTakeOutVisible:!1,currentCell:null,currentCabinetIdInDialog:null,currentRowIndex:null,currentColIndex:null,originalCellStatus:null,borrowForm:{phone:"",Customer:"",ProCode:"",CampalCode:"",Brow_at:null,BrowReson:""},takeoutForm:{TakeReson:"",Back_at:""},newCabinetForm:{name:"新柜体",location:"",description:"",rows:5,cols:6},hoverCell:null,tooltipVisible:!1,statusMap:[{text:"空闲",class:"status-free"},{text:"使用中",class:"status-in-use"},{text:"预定中",class:"status-reserved"},{text:"取出保留",class:"status-taken-reserved"}],nextCabinetId:1,Back_atOptions:{disabledDate:function(e){var t=new Date;return t.setFullYear(t.getFullYear()+2),e.getTime()>t.getTime()}}}},computed:Object(i.a)(Object(i.a)({},Object(c.d)("cabinet",["cabinets"])),{},{currentCabinet:function(){var e=this;return this.cabinets.find(function(t){return t.id===e.currentCabinetId})||{}},dialogTitle:function(){return this.currentCell?"柜格信息 - ".concat(this.currentCell.position):"柜格信息"}}),mounted:function(){this.getdata("first"),this.borrowForm.user=this.currentUser.name,this.borrowForm.phone=this.currentUser.phone},methods:Object(i.a)(Object(i.a)({},Object(c.b)("cabinet",["fetchCabinets","addCabinetAction","deleteCabinetAction","updateGrid"])),{},{getdata:function(e){var t=this;return Object(l.a)(Object(o.a)().m(function a(){var r,n;return Object(o.a)().w(function(a){for(;;)switch(a.p=a.n){case 0:return t.elbuttonloading=!0,t.tableloading=!0,a.p=1,a.n=2,u.e({isGetData:e});case 2:r=a.v,t.$store.commit("cabinet/SET_CABINETS",r.data),t.isAdmin=r.data.isAdmin,t.isAdmin_origin=r.data.isAdmin,t.currentUser=r.data.currentUser,t.CustomerOptions=r.data.CustomerOptions,t.errMsg=r.data.errMsg,t.errMsg?t.$alert(t.errMsg,"提示",{type:"warning"}):t.$message({message:"获取成功",type:"success"}),a.n=4;break;case 3:a.p=3,n=a.v,console.error("获取数据失败:",n),t.$message.error("获取数据失败");case 4:return a.p=4,t.elbuttonloading=!1,t.tableloading=!1,a.f(4);case 5:return a.a(2)}},a,null,[[1,3,4,5]])}))()},openAddCabinetDialog:function(){this.isAdmin?(this.dialogAddVisible=!0,this.newCabinetForm={name:"柜体".concat(this.nextCabinetId),location:"",description:"",rows:5,cols:6}):this.$message.warning("只有管理员可以添加柜体")},addCabinet:function(){var e=this;return Object(l.a)(Object(o.a)().m(function t(){var a,r,n,s,l,i;return Object(o.a)().w(function(t){for(;;)switch(t.p=t.n){case 0:return a=e.nextCabinetId++,r={id:a,name:e.newCabinetForm.name,location:e.newCabinetForm.location,description:e.newCabinetForm.description,rows:e.newCabinetForm.rows,cols:e.newCabinetForm.cols,gridData:[]},e.generateGrid(r),t.p=1,t.n=2,u.a(r);case 2:if(n=t.v,e.errMsg=n.data.errMsg,console.log("this.errMsg",e.errMsg,n.data.errMsg),!e.errMsg){t.n=3;break}return l=(null===(s=e.errMsg.name)||void 0===s?void 0:s[0])||"柜体名称重复",e.$alert(l,"提示",{type:"warning"}),t.a(2);case 3:e.$message({message:"获取成功",type:"success"});case 4:return t.n=5,e.getdata("update");case 5:e.currentCabinetId=a,e.dialogAddVisible=!1,e.$message.success("柜体".concat(a,"添加成功")),t.n=7;break;case 6:t.p=6,i=t.v,console.error("添加柜体失败:",i),e.$alert(i,"提示",{type:"warning"}),e.$message.error("添加柜体失败");case 7:return t.a(2)}},t,null,[[1,6]])}))()},confirmRemoveCabinet:function(e,t){var a=this;this.isAdmin?this.$confirm('确定要删除柜体 "'.concat(t,'" 吗? 此操作不可恢复。'),"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.removeCabinet(e)}).catch(function(){}):this.$message.warning("只有管理员可以删除柜体")},removeCabinet:function(e){var t=this;return Object(l.a)(Object(o.a)().m(function a(){var r,n;return Object(o.a)().w(function(a){for(;;)switch(a.p=a.n){case 0:if(t.isAdmin){a.n=1;break}return t.$message.warning("只有管理员可以删除柜体"),a.a(2);case 1:if(!(t.cabinets.length<=1)){a.n=2;break}return t.$message.error("不能删除最后一个柜体"),a.a(2);case 2:return a.p=2,a.n=3,u.d(e);case 3:if(r=a.v,t.errMsg=r.data.errMsg,!t.errMsg){a.n=4;break}t.$alert(t.errMsg,"提示",{type:"warning"}),a.n=6;break;case 4:return a.n=5,t.getdata("update");case 5:t.$message.success("删除成功");case 6:a.n=8;break;case 7:a.p=7,n=a.v,console.error("删除柜体失败:",n),t.$message.error("删除柜体失败");case 8:return a.a(2)}},a,null,[[2,7]])}))()},confirmCancelReserve:function(e,t,a,r){var n=this;this.$confirm("确定要取消柜格 ".concat(t.position," 的预约吗?"),"取消预约",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.cancelReserve(e,t.id,a,r)}).catch(function(){})},cancelReserve:function(e,t,a,r){var n=this;return Object(l.a)(Object(o.a)().m(function s(){var l,c,d,m;return Object(o.a)().w(function(s){for(;;)switch(s.p=s.n){case 0:if(-1!==(l=n.cabinets.findIndex(function(t){return t.id===e}))){s.n=1;break}return s.a(2);case 1:if(c=n.cabinets[l],2!==(d=c.gridData[a][r]).status){s.n=7;break}return s.p=2,s.n=3,u.b(t,{cabinetId:e,rowIndex:a,colIndex:r,gridId:t,cellData:Object(i.a)(Object(i.a)({},d),{},{status:0,user:"",phone:"",Customer:"",ProCode:"",CampalCode:"",notes:"",Brow_at:null,BrowReson:"",Back_at:null,Take_at:null,TakeReson:""}),action:"cancelReserve"});case 3:return s.v,s.n=4,n.getdata("update");case 4:n.$message.success("柜格 ".concat(d.position," 的预约已取消")),s.n=6;break;case 5:s.p=5,m=s.v,console.error("取消预约失败:",m),n.$message.error("取消预约失败");case 6:s.n=8;break;case 7:n.$message.warning("柜格 ".concat(d.position," 的预约状态已变更"));case 8:return s.a(2)}},s,null,[[2,5]])}))()},cancelTakenReserve:function(e,t,a,r){var n=this;return Object(l.a)(Object(o.a)().m(function s(){var l;return Object(o.a)().w(function(s){for(;;)switch(s.p=s.n){case 0:return s.p=0,s.n=1,u.g(t.id,{cabinetId:e,rowIndex:a,colIndex:r,cellData:Object(i.a)(Object(i.a)({},t),{},{Back_at:null,Take_at:null,TakeReson:"",status:1}),action:"cancelTakenReserve"});case 1:return s.v,s.n=2,n.getdata("update");case 2:n.$message.success("柜格 ".concat(t.position," 的保留状态已取消")),s.n=4;break;case 3:s.p=3,l=s.v,console.error("取消保留失败:",l),n.$message.error("取消保留失败");case 4:return s.a(2)}},s,null,[[0,3]])}))()},confirmReturnCell:function(e,t,a,r){var n=this;this.$confirm("确定要归还柜格 ".concat(t.position," 吗?"),"归还确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.returnCell(e,t,a,r)}).catch(function(){})},returnCell:function(e,t,a,r){var n=this;return Object(l.a)(Object(o.a)().m(function s(){var l;return Object(o.a)().w(function(s){for(;;)switch(s.p=s.n){case 0:return s.p=0,s.n=1,u.g(t.id,{cabinetId:e,rowIndex:a,colIndex:r,cellData:Object(i.a)(Object(i.a)({},t),{},{status:0,user:"",phone:"",Customer:"",ProCode:"",CampalCode:"",notes:"",Brow_at:null,BrowReson:"",Back_at:null,Take_at:null,TakeReson:""}),action:"returnCell"});case 1:return s.v,n.$message.success("柜格 ".concat(t.position," 已成功归还")),s.n=2,n.getdata("update");case 2:s.n=4;break;case 3:s.p=3,l=s.v,console.error("归还柜格失败:",l),n.$message.error("归还柜格失败");case 4:return s.a(2)}},s,null,[[0,3]])}))()},takeOutCell:function(e,t,a,r){this.currentCabinetIdInDialog=e,this.currentCell=Object(i.a)({},t),this.currentRowIndex=a,this.currentColIndex=r,this.dialogTakeOutVisible=!0,this.takeoutForm.Back_at=""},confirmTakeOut:function(){var e=this;return Object(l.a)(Object(o.a)().m(function t(){var a;return Object(o.a)().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.takeoutForm.Back_at){t.n=1;break}return e.$message.warning("请选择保留日期"),t.a(2);case 1:return t.p=1,t.n=2,u.g(e.currentCell.id,{cabinetId:e.currentCabinetIdInDialog,rowIndex:e.currentRowIndex,colIndex:e.currentColIndex,cellData:Object(i.a)(Object(i.a)({},e.currentCell),{},{status:3,Back_at:e.formatDateToISO(e.takeoutForm.Back_at),Take_at:e.formatDateToISO((new Date).toISOString().split("T")[0]),TakeReson:e.takeoutForm.TakeReson}),action:"confirmTakeOut"});case 2:return t.v,e.dialogTakeOutVisible=!1,t.n=3,e.getdata("update");case 3:e.$message.success("柜格 ".concat(e.currentCell.position," 已设为取出保留状态")),t.n=5;break;case 4:t.p=4,a=t.v,console.error("取出保留操作失败:",a),e.$message.error("取出保留操作失败");case 5:return t.a(2)}},t,null,[[1,4]])}))()},setActiveCabinet:function(e){this.currentCabinetId=e},generateGrid:function(e){e.gridData=[];for(var t=0;t<e.rows;t++){for(var a=[],r=String.fromCharCode(65+t),n=0;n<e.cols;n++){var s=this.statusMap[0],o={rowIndex:t,colIndex:n,position:"".concat(r).concat(n+1),status:0,statusText:s.text,statusClass:s.class,user:"",Customer:"",ProCode:"",CampalCode:"",phone:"",notes:"",Brow_at:null,BrowReson:"",Back_at:null,Take_at:null,TakeReson:""};a.push(o)}e.gridData.push(a)}},transformGridData:function(e){var t=e.map(function(e,t){return{id:"row-".concat(t),cells:s(e)}});return console.log("转换后的表格数据:",t),t},handleCellClick:function(e,t,a,r){this.currentCabinetIdInDialog=e,this.currentCell=Object(i.a)(Object(i.a)({},t),{},{rowIndex:a,colIndex:r}),this.currentRowIndex=a,this.currentColIndex=r,this.originalCellStatus=t.status,this.isAdmin?this.dialogAdminVisible=!0:0===t.status?(this.borrowForm={user:this.currentUser.name,phone:this.currentUser.phone},this.dialogUserBorrowVisible=!0):2===t.status&&t.user===this.currentUser.name||1===t.status&&t.user===this.currentUser.name||this.$message.info("柜格 ".concat(t.position," 当前不可操作"))},handleBorrow:function(){var e=this;return Object(l.a)(Object(o.a)().m(function t(){var a,r,n,s;return Object(o.a)().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.dialogUserBorrowVisible&&e.currentCell){t.n=1;break}return t.a(2);case 1:if(e.borrowForm.phone.trim()){t.n=2;break}return e.$message.warning("请输入联系电话"),t.a(2);case 2:if(a=e.currentCabinetIdInDialog,r=e.currentRowIndex,n=e.currentColIndex,a&&null!==r&&null!==n){t.n=3;break}return e.$message.error("操作失败：无法确定柜格位置"),t.a(2);case 3:return t.p=3,t.n=4,u.f(e.currentCell.id,{cabinetId:a,rowIndex:r,colIndex:n,gridId:e.currentCell.id,cellData:Object(i.a)(Object(i.a)({},e.currentCell),{},{status:2,phone:e.borrowForm.phone,Customer:e.borrowForm.Customer,ProCode:e.borrowForm.ProCode,CampalCode:e.borrowForm.CampalCode,BrowReson:e.borrowForm.BrowReson}),action:"UserBorrow"});case 4:return t.v,e.dialogUserBorrowVisible=!1,t.n=5,e.getdata("update");case 5:e.$message.success("柜格 ".concat(e.currentCell.position," 已预约成功，等待管理员确认")),t.n=7;break;case 6:t.p=6,s=t.v,console.error("借用操作失败:",s),e.$message.error("借用操作失败");case 7:return t.a(2)}},t,null,[[3,6]])}))()},saveCellInfo:function(){var e=this;return Object(l.a)(Object(o.a)().m(function t(){var a;return Object(o.a)().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.currentCabinetIdInDialog&&null!==e.currentRowIndex&&null!==e.currentColIndex&&e.currentCell.id){t.n=1;break}return e.dialogAdminVisible=!1,t.a(2);case 1:return 2===e.originalCellStatus&&1===e.currentCell.status&&(e.currentCell.Brow_at=(new Date).toISOString().split("T")[0]),1===e.originalCellStatus&&0===e.currentCell.status&&(e.currentCell.user="",e.currentCell.phone="",e.currentCell.Customer="",e.currentCell.ProCode="",e.currentCell.CampalCode="",e.currentCell.notes="",e.currentCell.Brow_at=null,e.currentCell.BrowReson="",e.currentCell.Take_at=null,e.currentCell.TakeReson="",e.currentCell.Back_at=null),t.p=2,t.n=3,u.g(e.currentCell.id,{cellData:Object(i.a)({},e.currentCell)});case 3:return t.v,e.dialogAdminVisible=!1,e.$message.success("柜格信息已更新"),t.n=4,e.getdata("update");case 4:t.n=6;break;case 5:t.p=5,a=t.v,console.error("保存柜格信息失败:",a),e.$message.error("保存柜格信息失败");case 6:return t.a(2)}},t,null,[[2,5]])}))()},confirmBorrow:function(e,t,a,r){var n=this;return Object(l.a)(Object(o.a)().m(function s(){return Object(o.a)().w(function(s){for(;;)switch(s.n){case 0:n.$confirm("确定要确认柜格 ".concat(t.position," 的借用吗?"),"确认借出",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(l.a)(Object(o.a)().m(function s(){var l;return Object(o.a)().w(function(s){for(;;)switch(s.p=s.n){case 0:return s.p=0,s.n=1,u.c(t.id,{cabinetId:e,rowIndex:a,colIndex:r,gridId:t.id,cellData:Object(i.a)(Object(i.a)({},t),{},{status:1}),action:"confirmBorrow"});case 1:return s.v,s.n=2,n.getdata("update");case 2:n.$message.success("柜格 ".concat(t.position," 已确认借出")),s.n=4;break;case 3:s.p=3,l=s.v,console.error("确认借出失败:",l),n.$message.error("确认借出失败");case 4:return s.a(2)}},s,null,[[0,3]])}))).catch(function(){});case 1:return s.a(2)}},s)}))()},formatCompactDate:function(e){if(!e)return"";var t=new Date(e);return"".concat(t.getMonth()+1,"/").concat(t.getDate())},formatDateToISO:function(e){return e?e.includes("T")?e:e+"T00:00:00":null},isOverdue:function(e){if(!e.Brow_at)return!1;var t=new Date(e.Brow_at),a=new Date,r=new Date;return r.setFullYear(a.getFullYear()-2),t<r},isReserveOverdue:function(e){return!!e.Back_at&&new Date(e.Back_at)<new Date},formatDate:function(e){return e?new Date(e).toLocaleDateString():""},getTooltipContent:function(e){var t="柜格 ".concat(e.position," 信息\n");if(t+="状态: ".concat(e.statusText,"\n"),e.user&&(t+="借用人: ".concat(e.user,"\n")),e.phone&&(t+="电话: ".concat(e.phone,"\n")),e.Brow_at){var a=this.isOverdue(e);t+="借用日期: ".concat(this.formatDate(e.Brow_at)),a&&(t+=" (超期)"),t+="\n"}if(e.Back_at){var r=this.isReserveOverdue(e);t+="保留日期: ".concat(this.formatDate(e.Back_at)),r&&(t+=" (超期)"),t+="\n"}return e.Take_at&&(t+="取出日期: ".concat(this.formatDate(e.Take_at),"\n")),this.isOverdue(e)&&(t+="警告: 已超期超过2年!\n"),t},getTotalCells:function(e){return e.rows*e.cols},getFreeCells:function(e){return this.countCellsByStatus(e,0)},getInUseCells:function(e){return this.countCellsByStatus(e,1)},getReservedCells:function(e){return this.countCellsByStatus(e,2)},getTakenCells:function(e){return this.countCellsByStatus(e,3)},countCellsByStatus:function(e,t){if(!e.gridData||!e.gridData.length)return 0;var a=0;return e.gridData.forEach(function(e){e.forEach(function(e){e.status===t&&a++})}),a},getStatusClass:function(e){switch(e){case 0:return"status-free";case 1:return"status-in-use";case 2:return"status-reserved";case 3:return"status-taken-reserved";default:return"status-free"}}})},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"cabinet-app"}},[a("div",{staticClass:"cabinet-container"},[e._m(0),e._v(" "),a("div",{staticClass:"cabinets-bar"},[e.isAdmin?a("el-button",{attrs:{loading:e.elbuttonloading,type:"primary",icon:"el-icon-plus"},on:{click:e.openAddCabinetDialog}},[e._v("添加柜体")]):e._e(),e._v(" "),a("div",{staticClass:"cabinets-tabs"},e._l(e.cabinets,function(t,r){return a("div",{key:t.id,staticClass:"cabinet-tab",class:{active:e.currentCabinetId===t.id},on:{click:function(a){return e.setActiveCabinet(t.id)}}},[e._v("\n          "+e._s(t.name)+"\n          "),e._v(" "),e.isAdmin?a("span",{staticClass:"delete-cabinet-btn",attrs:{title:"删除柜体"},on:{click:function(a){return a.stopPropagation(),e.confirmRemoveCabinet(t.id,t.name)}}},[e._v("×")]):e._e()])}),0)],1),e._v(" "),e.isAdmin_origin?a("div",{staticClass:"control-panel"},[a("div",{staticClass:"control-row"},[a("el-radio-group",{attrs:{size:"medium"},model:{value:e.isAdmin,callback:function(t){e.isAdmin=t},expression:"isAdmin"}},[a("el-radio-button",{staticStyle:{padding:"8px 20px","border-radius":"20px"},attrs:{label:!0}},[e._v("管理员")]),e._v(" "),a("el-radio-button",{staticStyle:{padding:"8px 20px","border-radius":"20px"},attrs:{label:!1}},[e._v("普通用户")])],1)],1)]):e._e(),e._v(" "),e._l(e.cabinets,function(t){return a("div",{key:t.id,staticClass:"cabinet-section"},[a("div",{staticClass:"cabinet-header"},[a("h2",[e._v("柜体 "+e._s(t.name))]),e._v(" "),e.isAdmin?a("el-button",{staticStyle:{color:"#f56c6c"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.confirmRemoveCabinet(t.id,t.name)}}},[e._v("删除此柜体")]):e._e()],1),e._v(" "),a("div",{staticClass:"grid-container"},[t.gridData&&t.gridData.length?a("div",{staticClass:"grid-table-container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],staticClass:"grid-table",attrs:{data:e.transformGridData(t.gridData),"show-header":!1,border:"","row-style":{height:"120px"},"cell-style":{padding:"0",textAlign:"center",verticalAlign:"middle"}}},e._l(t.cols,function(r,n){return a("el-table-column",{key:n,attrs:{label:""},scopedSlots:e._u([{key:"default",fn:function(r){return[a("el-tooltip",{attrs:{content:e.getTooltipContent(r.row.cells[n]),effect:"light",placement:"top","popper-class":"cell-tooltip",disabled:!e.hoverCell}},[a("div",{staticClass:"grid-cell",class:[e.getStatusClass(r.row.cells[n].status),{"status-overdue":e.isOverdue(r.row.cells[n])}],on:{mouseover:function(t){e.hoverCell=r.row.cells[n]},mouseleave:function(t){e.hoverCell=null},click:function(a){return e.handleCellClick(t.id,r.row.cells[n],r.$index,n)}}},[a("div",{staticClass:"cell-content-container"},[a("div",{staticClass:"position-id"},[e._v(e._s(r.row.cells[n].position))]),e._v(" "),a("div",{staticClass:"cell-actions"},[e.isAdmin||2!==r.row.cells[n].status||r.row.cells[n].user!==e.currentUser.name?e._e():a("div",{staticClass:"action-button cancel-reserve-btn",on:{click:function(a){return a.stopPropagation(),e.confirmCancelReserve(t.id,r.row.cells[n],r.$index,n)}}},[e._v("\n                            ×\n                          ")]),e._v(" "),e.isAdmin||1!==r.row.cells[n].status||r.row.cells[n].user!==e.currentUser.name?e._e():a("div",{staticClass:"action-button take-out-btn",on:{click:function(a){return a.stopPropagation(),e.takeOutCell(t.id,r.row.cells[n],r.$index,n)}}},[e._v("\n                            →\n                          ")]),e._v(" "),e.isAdmin||1!==r.row.cells[n].status||r.row.cells[n].user!==e.currentUser.name?e._e():a("div",{staticClass:"action-button return-btn",on:{click:function(a){return a.stopPropagation(),e.confirmReturnCell(t.id,r.row.cells[n],r.$index,n)}}},[e._v("\n                            ↻\n                          ")]),e._v(" "),e.isAdmin||3!==r.row.cells[n].status||r.row.cells[n].user!==e.currentUser.name?e._e():a("div",{staticClass:"action-button cancel-taken-btn",on:{click:function(a){return a.stopPropagation(),e.cancelTakenReserve(t.id,r.row.cells[n],r.$index,n)}}},[e._v("\n                            ×\n                          ")]),e._v(" "),e.isAdmin&&2===r.row.cells[n].status?a("div",{staticClass:"action-button confirm-borrow-btn",on:{click:function(a){return a.stopPropagation(),e.confirmBorrow(t.id,r.row.cells[n],r.$index,n)}}},[e._v("\n                            ✓\n                          ")]):e._e()]),e._v(" "),a("div",{staticClass:"status-user-row"},[a("div",{staticClass:"status-text",class:{"overdue-date":e.isReserveOverdue(r.row.cells[n])}},[e._v("\n                            "+e._s(r.row.cells[n].statusText)+"\n                          ")]),e._v(" "),r.row.cells[n].user?a("div",{staticClass:"user-info"},[e._v("\n                            "+e._s(r.row.cells[n].user)+"\n                          ")]):e._e()]),e._v(" "),a("div",{staticClass:"date-row"},[r.row.cells[n].Brow_at?a("div",{staticClass:"date-info",class:{"overdue-date":e.isOverdue(r.row.cells[n])}},[e._v("\n                            借: "+e._s(e.formatCompactDate(r.row.cells[n].Brow_at))+"\n                          ")]):e._e(),e._v(" "),r.row.cells[n].Back_at?a("div",{staticClass:"date-info",class:{"overdue-date":e.isReserveOverdue(r.row.cells[n])}},[e._v("\n                            保: "+e._s(e.formatCompactDate(r.row.cells[n].Back_at))+"\n                          ")]):e._e(),e._v(" "),r.row.cells[n].Take_at?a("div",{staticClass:"date-info"},[e._v("\n                            取: "+e._s(e.formatCompactDate(r.row.cells[n].Take_at))+"\n                          ")]):e._e()])])])])]}}],null,!0)})}),1)],1):a("el-empty",{attrs:{description:"请添加柜体配置","image-size":200}}),e._v(" "),e._m(1,!0)],1),e._v(" "),a("div",{staticClass:"statistics"},[a("div",{staticClass:"stat-card"},[a("div",{staticClass:"stat-value"},[e._v(e._s(e.getTotalCells(t)))]),e._v(" "),a("div",{staticClass:"stat-label"},[e._v("总柜格数")])]),e._v(" "),a("div",{staticClass:"stat-card"},[a("div",{staticClass:"stat-value"},[e._v(e._s(e.getFreeCells(t)))]),e._v(" "),a("div",{staticClass:"stat-label"},[e._v("空闲柜格")])]),e._v(" "),a("div",{staticClass:"stat-card"},[a("div",{staticClass:"stat-value"},[e._v(e._s(e.getInUseCells(t)))]),e._v(" "),a("div",{staticClass:"stat-label"},[e._v("使用中柜格")])]),e._v(" "),a("div",{staticClass:"stat-card"},[a("div",{staticClass:"stat-value"},[e._v(e._s(e.getReservedCells(t)))]),e._v(" "),a("div",{staticClass:"stat-label"},[e._v("预定中柜格")])]),e._v(" "),a("div",{staticClass:"stat-card"},[a("div",{staticClass:"stat-value"},[e._v(e._s(e.getTakenCells(t)))]),e._v(" "),a("div",{staticClass:"stat-label"},[e._v("取出保留")])])])])}),e._v(" "),e._m(2)],2),e._v(" "),a("el-dialog",{attrs:{title:"添加新柜体",visible:e.dialogAddVisible,width:"500px"},on:{"update:visible":function(t){e.dialogAddVisible=t}}},[a("el-form",{attrs:{model:e.newCabinetForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"柜体名称"}},[a("el-input",{attrs:{placeholder:"请输入柜体名称"},model:{value:e.newCabinetForm.name,callback:function(t){e.$set(e.newCabinetForm,"name",t)},expression:"newCabinetForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"柜体位置"}},[a("el-input",{attrs:{placeholder:"请输入柜体位置"},model:{value:e.newCabinetForm.location,callback:function(t){e.$set(e.newCabinetForm,"location",t)},expression:"newCabinetForm.location"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{placeholder:"请输入柜体描述"},model:{value:e.newCabinetForm.description,callback:function(t){e.$set(e.newCabinetForm,"description",t)},expression:"newCabinetForm.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"行数"}},[a("el-input-number",{attrs:{min:1,max:20},model:{value:e.newCabinetForm.rows,callback:function(t){e.$set(e.newCabinetForm,"rows",t)},expression:"newCabinetForm.rows"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"列数"}},[a("el-input-number",{attrs:{min:1,max:20},model:{value:e.newCabinetForm.cols,callback:function(t){e.$set(e.newCabinetForm,"cols",t)},expression:"newCabinetForm.cols"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogAddVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addCabinet}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogAdminVisible,width:"500px"},on:{"update:visible":function(t){e.dialogAdminVisible=t}}},[e.currentCell?a("div",[a("el-form",{staticClass:"dialog-form",attrs:{model:e.currentCell,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"位置编号"}},[a("el-input",{model:{value:e.currentCell.position,callback:function(t){e.$set(e.currentCell,"position",t)},expression:"currentCell.position"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"当前状态"}},[a("el-select",{model:{value:e.currentCell.status,callback:function(t){e.$set(e.currentCell,"status",t)},expression:"currentCell.status"}},[a("el-option",{attrs:{label:"空闲",value:0}}),e._v(" "),a("el-option",{attrs:{label:"使用中",value:1}}),e._v(" "),a("el-option",{attrs:{label:"预定中",value:2}}),e._v(" "),a("el-option",{attrs:{label:"取出保留",value:3}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"使用者"}},[a("el-input",{model:{value:e.currentCell.user,callback:function(t){e.$set(e.currentCell,"user",t)},expression:"currentCell.user"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{model:{value:e.currentCell.phone,callback:function(t){e.$set(e.currentCell,"phone",t)},expression:"currentCell.phone"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Customer",prop:"Customer"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.currentCell.Customer,callback:function(t){e.$set(e.currentCell,"Customer",t)},expression:"currentCell.Customer"}},e._l(e.CustomerOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"ProCode"}},[a("el-input",{model:{value:e.currentCell.ProCode,callback:function(t){e.$set(e.currentCell,"ProCode",t)},expression:"currentCell.ProCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"CampalCode"}},[a("el-input",{model:{value:e.currentCell.CampalCode,callback:function(t){e.$set(e.currentCell,"CampalCode",t)},expression:"currentCell.CampalCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"留样日期(放回)"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.currentCell.Brow_at,callback:function(t){e.$set(e.currentCell,"Brow_at",t)},expression:"currentCell.Brow_at"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"留样原因"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.currentCell.BrowReson,callback:function(t){e.$set(e.currentCell,"BrowReson",t)},expression:"currentCell.BrowReson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"取出日期"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.currentCell.Take_at,callback:function(t){e.$set(e.currentCell,"Take_at",t)},expression:"currentCell.Take_at"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"取出保留原因"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.currentCell.TakeReson,callback:function(t){e.$set(e.currentCell,"TakeReson",t)},expression:"currentCell.TakeReson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"保留日期"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.currentCell.Back_at,callback:function(t){e.$set(e.currentCell,"Back_at",t)},expression:"currentCell.Back_at"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注信息"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.currentCell.notes,callback:function(t){e.$set(e.currentCell,"notes",t)},expression:"currentCell.notes"}})],1)],1)],1):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogAdminVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveCellInfo}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"柜格借用",visible:e.dialogUserBorrowVisible,width:"500px"},on:{"update:visible":function(t){e.dialogUserBorrowVisible=t}}},[e.currentCell?a("div",[a("el-form",{attrs:{model:e.borrowForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"位置编号"}},[a("el-input",{attrs:{disabled:""},model:{value:e.currentCell.position,callback:function(t){e.$set(e.currentCell,"position",t)},expression:"currentCell.position"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{model:{value:e.borrowForm.phone,callback:function(t){e.$set(e.borrowForm,"phone",t)},expression:"borrowForm.phone"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Customer",prop:"Customer"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.borrowForm.Customer,callback:function(t){e.$set(e.borrowForm,"Customer",t)},expression:"borrowForm.Customer"}},e._l(e.CustomerOptions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"ProCode"}},[a("el-input",{model:{value:e.borrowForm.ProCode,callback:function(t){e.$set(e.borrowForm,"ProCode",t)},expression:"borrowForm.ProCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"CampalCode"}},[a("el-input",{model:{value:e.borrowForm.CampalCode,callback:function(t){e.$set(e.borrowForm,"CampalCode",t)},expression:"borrowForm.CampalCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"留样原因"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.borrowForm.BrowReson,callback:function(t){e.$set(e.borrowForm,"BrowReson",t)},expression:"borrowForm.BrowReson"}})],1)],1)],1):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogUserBorrowVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleBorrow}},[e._v("借 用")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"取出保留",visible:e.dialogTakeOutVisible,width:"400px"},on:{"update:visible":function(t){e.dialogTakeOutVisible=t}}},[e.currentCell?a("div",[a("p",[e._v("确定要将柜格 "),a("strong",[e._v(e._s(e.currentCell.position))]),e._v(" 设置为取出保留状态吗？")]),e._v(" "),a("el-form",{attrs:{model:e.takeoutForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"取出保留原因"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.takeoutForm.TakeReson,callback:function(t){e.$set(e.takeoutForm,"TakeReson",t)},expression:"takeoutForm.TakeReson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"保留日期（放回）"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.Back_atOptions,placeholder:"选择日期"},model:{value:e.takeoutForm.Back_at,callback:function(t){e.$set(e.takeoutForm,"Back_at",t)},expression:"takeoutForm.Back_at"}})],1)],1)],1):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTakeOutVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmTakeOut}},[e._v("确 定")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"cabinet-main-header"},[t("h1",[this._v("智能柜管理系统")]),this._v(" "),t("p",[this._v("动态生成柜格布局，实时监控柜格状态")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"legend"},[a("div",{staticClass:"legend-item"},[a("div",{staticClass:"legend-color legend-free"}),e._v(" "),a("span",[e._v("空闲")])]),e._v(" "),a("div",{staticClass:"legend-item"},[a("div",{staticClass:"legend-color legend-in-use"}),e._v(" "),a("span",[e._v("使用中")])]),e._v(" "),a("div",{staticClass:"legend-item"},[a("div",{staticClass:"legend-color legend-reserved"}),e._v(" "),a("span",[e._v("预定中")])]),e._v(" "),a("div",{staticClass:"legend-item"},[a("div",{staticClass:"legend-color legend-taken-reserved"}),e._v(" "),a("span",[e._v("取出保留")])]),e._v(" "),a("div",{staticClass:"legend-item"},[a("div",{staticClass:"legend-color status-overdue"}),e._v(" "),a("span",[e._v("超期")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"cabinet-footer"},[t("p",[this._v("智能柜管理系统 © 2023 | 基于 Vue.js 和 Element UI 构建")])])}]};var v=a("VU/8")(d,m,!1,function(e){a("+jmy")},"data-v-19aada10",null);t.default=v.exports}});
//# sourceMappingURL=11.e9ec2d1126e7544da099.js.map