{"version":3,"sources":["webpack:///src/views/Register.vue","webpack:///./src/api/user.js","webpack:///./src/views/Register.vue?4e99","webpack:///./src/views/Register.vue"],"names":["Register","data","registerForm","phone","code","password","confirmPassword","loading","codeButtonText","codeButtonDisabled","countdown","methods","sendVerificationCode","_this","this","_asyncToGenerator","_regenerator","m","_callee","_t","w","_context","p","n","test","$message","error","a","type","request","url","method","headers","X-CSRFToken","Cookies","get","v","startCountdown","success","console","_this2","timer","setInterval","concat","clearInterval","handleRegister","_this3","_callee2","_error$response","_error$response$data","_t2","_context2","post","$router","push","response","detail","f","goToLogin","views_Register","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","model","_v","prefix-icon","placeholder","maxlength","value","callback","$$v","$set","expression","staticStyle","width","margin-left","disabled","on","click","_s","show-password","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/4.4f593f5209b8e564bd1c.js","sourcesContent":["<template>\n  <div class=\"register-container\">\n    <el-form ref=\"form\" :model=\"registerForm\" class=\"register-form\">\n      <h2>用户注册</h2>\n\n      <el-form-item>\n        <el-input\n          v-model=\"registerForm.phone\"\n          prefix-icon=\"el-icon-mobile-phone\"\n          placeholder=\"手机号码\"\n          maxlength=\"11\"\n        ></el-input>\n      </el-form-item>\n\n      <el-form-item>\n        <div class=\"code-input\">\n          <el-input\n            v-model=\"registerForm.code\"\n            prefix-icon=\"el-icon-message\"\n            placeholder=\"验证码\"\n            style=\"width: 60%\"\n          ></el-input>\n          <el-button\n            type=\"primary\"\n            style=\"width: 35%; margin-left: 5%\"\n            :disabled=\"codeButtonDisabled\"\n            @click=\"sendVerificationCode\"\n          >\n            {{ codeButtonText }}\n          </el-button>\n        </div>\n      </el-form-item>\n\n      <el-form-item>\n        <el-input\n          v-model=\"registerForm.password\"\n          prefix-icon=\"el-icon-lock\"\n          type=\"password\"\n          placeholder=\"设置密码\"\n          show-password\n        ></el-input>\n      </el-form-item>\n\n      <el-form-item>\n        <el-input\n          v-model=\"registerForm.confirmPassword\"\n          prefix-icon=\"el-icon-lock\"\n          type=\"password\"\n          placeholder=\"确认密码\"\n          show-password\n        ></el-input>\n      </el-form-item>\n\n      <el-form-item>\n        <el-button\n          type=\"primary\"\n          @click=\"handleRegister\"\n          :loading=\"loading\"\n          class=\"register-btn\"\n        >注册</el-button>\n      </el-form-item>\n\n      <div class=\"login-link\">\n        <el-link type=\"primary\" @click=\"goToLogin\">返回登录</el-link>\n      </div>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport * as userreg from '@/api/user'\nimport request from '@/utils/request' // 添加缺失的request导入\n\nexport default {\n  data() {\n    return {\n      registerForm: {\n        phone: '',\n        code: '',\n        password: '',\n        confirmPassword: ''\n      },\n      loading: false,\n      codeButtonText: '获取验证码',\n      codeButtonDisabled: false,\n      countdown: 60\n    };\n  },\n  methods: {\n    async sendVerificationCode() {\n      if (!this.registerForm.phone || !/^1[3-9]\\d{9}$/.test(this.registerForm.phone)) {\n        this.$message.error('请输入有效的手机号码');\n        return;\n      }\n\n      // 调用发送验证码API\n      this.codeButtonDisabled = true;\n      try {\n        // 使用await等待API调用\n        const response = await userreg.send_verification_code({\n          phone: this.registerForm.phone,\n          type: 'register'\n        });\n\n        // 成功发送后启动倒计时\n        this.startCountdown();\n        this.$message.success('验证码已发送');\n      } catch(error) {\n        console.error('发送验证码失败:', error);\n        this.$message.error('发送验证码失败');\n        this.codeButtonDisabled = false;\n      }\n    },\n\n    startCountdown() {\n      const timer = setInterval(() => {\n        this.codeButtonText = `${this.countdown}秒后重新获取`;\n        this.countdown--;\n\n        if (this.countdown < 0) {\n          clearInterval(timer);\n          this.codeButtonText = '获取验证码';\n          this.codeButtonDisabled = false;\n          this.countdown = 60;\n        }\n      }, 1000);\n    },\n\n    // 修改为异步函数\n    async handleRegister() {\n      // 表单验证\n      if (this.registerForm.password !== this.registerForm.confirmPassword) {\n        this.$message.error('两次输入的密码不一致');\n        return;\n      }\n\n      this.loading = true;\n      try {\n        // 使用await等待注册结果\n        const response = await request.post('/api/register/', {\n          phone: this.registerForm.phone,\n          code: this.registerForm.code,\n          password: this.registerForm.password\n        });\n\n        this.$message.success('注册成功');\n        this.$router.push('/login');\n      } catch(error) {\n        console.error('注册失败:', error);\n        this.$message.error(error.response?.data?.detail || '注册失败');\n      } finally {\n        this.loading = false;\n      }\n    },\n\n    goToLogin() {\n      this.$router.push('/login');\n    }\n  }\n};\n</script>\n\n<style scoped>\n.register-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100vh;\n  background-color: #2d3a4b;\n}\n\n.register-form {\n  width: 380px;\n  padding: 40px;\n  background-color: #fff;\n  border-radius: 6px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n\n.register-form h2 {\n  margin-bottom: 30px;\n  text-align: center;\n  color: #333;\n}\n\n.code-input {\n  display: flex;\n}\n\n.register-btn {\n  width: 100%;\n}\n\n.login-link {\n  text-align: center;\n  margin-top: 20px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/Register.vue","// src/api/user.js\nimport request from '@/utils/request' // 确保你已经有request.js\nimport Cookies from 'js-cookie' // 确保这里正确导入\n\nexport function login(data) {\n  return request({\n    url: '/api/login/',\n    method: 'post',\n    data\n  })\n}\n\nexport function send_verification_code(data) {\n  return request({\n    url: '/api/send_verification_code/',\n    method: 'post',\n    headers: {\n      'X-CSRFToken': Cookies.get('csrftoken')  // 关键：添加CSRF token，Django默认要求所有非安全的HTTP方法（如POST、PUT、PATCH、DELETE）都需要提供CSRF token\n    },\n    data\n  })\n}\n\nexport function register(data) {\n  return request({\n    url: '/api/register/',\n    method: 'post',\n    headers: {\n      'X-CSRFToken': Cookies.get('csrftoken')  // 关键：添加CSRF token，Django默认要求所有非安全的HTTP方法（如POST、PUT、PATCH、DELETE）都需要提供CSRF token\n    },\n    data\n  })\n}\n\nexport function reset_password(data) {\n  return request({\n    url: '/api/reset_password/',\n    method: 'post',\n    headers: {\n      'X-CSRFToken': Cookies.get('csrftoken')  // 关键：添加CSRF token，Django默认要求所有非安全的HTTP方法（如POST、PUT、PATCH、DELETE）都需要提供CSRF token\n    },\n    data\n  })\n}\n\nexport function logout() {\n  return request({\n    url: '/api/reset_password/',\n    method: 'post'\n  })\n}\n\nexport function getUserInfo() {\n  return request({\n    url: '/api/userinfo/',\n    method: 'get'\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/user.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"register-container\"},[_c('el-form',{ref:\"form\",staticClass:\"register-form\",attrs:{\"model\":_vm.registerForm}},[_c('h2',[_vm._v(\"用户注册\")]),_vm._v(\" \"),_c('el-form-item',[_c('el-input',{attrs:{\"prefix-icon\":\"el-icon-mobile-phone\",\"placeholder\":\"手机号码\",\"maxlength\":\"11\"},model:{value:(_vm.registerForm.phone),callback:function ($$v) {_vm.$set(_vm.registerForm, \"phone\", $$v)},expression:\"registerForm.phone\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('div',{staticClass:\"code-input\"},[_c('el-input',{staticStyle:{\"width\":\"60%\"},attrs:{\"prefix-icon\":\"el-icon-message\",\"placeholder\":\"验证码\"},model:{value:(_vm.registerForm.code),callback:function ($$v) {_vm.$set(_vm.registerForm, \"code\", $$v)},expression:\"registerForm.code\"}}),_vm._v(\" \"),_c('el-button',{staticStyle:{\"width\":\"35%\",\"margin-left\":\"5%\"},attrs:{\"type\":\"primary\",\"disabled\":_vm.codeButtonDisabled},on:{\"click\":_vm.sendVerificationCode}},[_vm._v(\"\\n          \"+_vm._s(_vm.codeButtonText)+\"\\n        \")])],1)]),_vm._v(\" \"),_c('el-form-item',[_c('el-input',{attrs:{\"prefix-icon\":\"el-icon-lock\",\"type\":\"password\",\"placeholder\":\"设置密码\",\"show-password\":\"\"},model:{value:(_vm.registerForm.password),callback:function ($$v) {_vm.$set(_vm.registerForm, \"password\", $$v)},expression:\"registerForm.password\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-input',{attrs:{\"prefix-icon\":\"el-icon-lock\",\"type\":\"password\",\"placeholder\":\"确认密码\",\"show-password\":\"\"},model:{value:(_vm.registerForm.confirmPassword),callback:function ($$v) {_vm.$set(_vm.registerForm, \"confirmPassword\", $$v)},expression:\"registerForm.confirmPassword\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{staticClass:\"register-btn\",attrs:{\"type\":\"primary\",\"loading\":_vm.loading},on:{\"click\":_vm.handleRegister}},[_vm._v(\"注册\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"login-link\"},[_c('el-link',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.goToLogin}},[_vm._v(\"返回登录\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6ba6f09a\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/Register.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6ba6f09a\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Register.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Register.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Register.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6ba6f09a\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Register.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6ba6f09a\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/Register.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}